#1 简介
在这节课中 我们将看看如何进一步增强redux应用程序，我们将实现中间件来为store添加一些新功能并探索一些更容易扩展构建应用的方式。

我们可以通过使用中间件和更加可预测的应用结构，进一步优化我们的 Redux 应用。我们来详细了解下吧！

#2 什么是中间件
##2.1 video1
中间件是拦截请求或进程的代码，通常会重定向或产生某种副作用，在redux中，中间件是存在于分派动作和reducer之间的软件，有了中间件 我们可以在分派的动作到达reducer之前，拦截和修改它，或者甚至在分派发生时运行某种代码。中间件是一框强大的工具，让我们扩展应用程序的功能。
![](https://s3.cn-north-1.amazonaws.com.cn/u-img/95619ccb-5ee4-40f3-a0f0-3399d3303210)
**正如redux文档所描述的，中间件是在派遣action和它抵达reducer的时间点之间的第三方扩展点。**

##2.2 中间件 和 Redux
你已经知道，单向数据流使 reducer 应用具有可预测性：为了改变 store 的状态，action 描述更改必须被派发到 reducer。然后 reducer 依次返回新的状态。

在派发 action 和 reducer 之间，我们可以引入一种叫做`中间件`的软件在 action 抵达 reducer 之前来拦截它。正如  [Redux文档 ](http://redux.js.org/docs/advanced/Middleware.html)所描述的，你可以将中间件看做：

>…是在派发 action 和它抵达 reducer 的时间点之间的第三方扩展。

中间件收到该 action 后，它可以执行大量的操作，包括：

* 产生副作用（例如[记录状态](https://github.com/evgenyrodionov/redux-logger))
* 自己处理 action（例如发出异步 HTTP 请求）
* 重定向该 action（例如重定向到另一个中间件）
* 在派发期间运行一些代码
* 派发追加的 action

...它在将 action 传递给 reducer 之前执行所有这些操作！

## 2.3 中间件总结
中间件可以采用与 Redux 相同的单向状态管理模式，特别是中间件可以在派遣的 action 抵达 reducer 之前拦截它，然后重定向该 action 或产生副作用。

我们将在下个部分详细讲解一个副作用，使用 `logger` 中间件向控制台输出有价值的信息。

##2.4 更多资料
* [Redux 文档中的中间件](http://redux.js.org/docs/advanced/Middleware.html)
* [在 React/Redux 中创建自定义中间件](https://medium.com/@jihdeh/creating-custom-middleware-in-react-redux-961570459ecb)

##3 使用中间件
##3.1 video1
现在我们现在知道了中间件可以做什么，那么我们如何将中间件应用于redux应用程序呢？好消息是它可以在应用程序中的一个位置集中：创建store时，在课程早些时候 当我们创建store时，我们只传入一个reducer,createStore实际上可以接受可选参数enhancer,如果我们想将中间件用于应用程序，使用来自redux的applyMiddleware函数就可以了，此函数可以接受多个参数，那么如果需要，我们实际上可以将多个中间件应用到我们的应用程序，下面来看看例子，首先是logger中间件。
```
createStore(reducer,applyMiddleware())
```
##3.2 中间件位于 Redux 应用的哪个位置？
还记得`createStore()` 方法用来创建 Redux store。除了传入 reducer（经常是组合的“根 reducer”），`createStore() `还可以接受可选 `enhancer` 参数！以下是 `createStore()` 的方法签名：

```
store.createStore(reducer, [preloadedState], [enhancer])
```

Redux 为我们提供了 `applyMiddleware()` 函数，我可以将其用作 `enhancer `函数的参数。`applyMiddleware()` 可以根据需要接受多个参数，我们可以在一个应用中使用多个中间件。我们看看具体代码，从 `logger` 中间件开始！

##3.2 示例：logger 中间件
Redux 是网络应用的“可预测状态容器”。当 action 被派遣时，我们希望看到新的状态被处理和保存（例如，状态不能自己更新，外部资源也不能直接写入状态）。如果能记录发生在应用中的每个 action，以及其变化前后的状态，岂不是很棒？

我们可以应用“logger”中间件来实现这一点！logger 会产生以下**副作用**：输出 reducer 处理 action 前后的 store 的状态

我们来了解下吧！

##3.3 video2
[这里是本视频所做更改的commit](https://github.com/udacity/reactnd-udacimeals-complete/commit/2b60fe731b2e4f8ebcfaaafc0ac36ecd11e5215d)

>💡 redux-logger npm 软件包💡
在上个视频中，我们使用了自定义 logger 将 store 的状态输出到控制台中。你也可以参阅 redux-logger，了解这个预构建的日志工具。安装指令：

>```
npm install --save redux-logger
```

>redux-logger 自带默认选项，但是你也可以根据需要添加[其他自定义内容！](https://github.com/evgenyrodionov/redux-logger#options)

##3.4 总结
我们要在 Redux 应用的一个中心位置（创建 store 时）应用中间件。`createStore()` 方法必须获取 reducer 参数，但是我们也可以传入可选 `enhancer` 参数。该参数是 Redux 的 `applyMiddleware() `函数，它可以接受中间件本身的多个实例。

##3.5 更多资料
[redux-logger](https://github.com/evgenyrodionov/redux-logger)