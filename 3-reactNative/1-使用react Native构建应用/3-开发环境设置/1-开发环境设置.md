# å¼€å‘ç¯å¢ƒè®¾ç½®

## åˆ›å»º React Native åº”ç”¨
å½“æˆ‘ä»¬åœ¨æ­¤è¯¾ç¨‹ä¸­æ„å»ºåº”ç”¨æ—¶ï¼Œæˆ‘ä»¬è¦é¢å‘ Android å’Œ iOS ä¸¤ä¸ªå¹³å°æ„å»ºã€‚é‚£ä¹ˆæˆ‘ä»¬é¢ä¸´çš„ä¸€ä¸ªéš¾é¢˜æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦æ”¯æŒä¸¤ä¸ªç‹¬ç«‹çš„å¼€å‘ç¯å¢ƒï¼šiOS ä½¿ç”¨ [Xcode](https://developer.apple.com/xcode/)ï¼ŒAndroid ä½¿ç”¨ [Android Studio](https://developer.android.com/studio/index.html)ã€‚è¿™ä¸ºå­¦ä¹ æœ¬è¯¾ç¨‹ä¸­å¸¦æ¥äº†å¾ˆå¤šå¤æ‚æ€§ï¼›æ¯•ç«Ÿï¼ŒXcode å’Œ Android Studio éƒ½å¯ä»¥æˆä¸ºå•ç‹¬çš„ä¸€å¥—è¯¾ç¨‹ï¼

å¹¸è¿çš„æ˜¯ï¼Œç°åœ¨æˆ‘ä»¬æœ‰ä¸€ç§æ–°å·¥å…·å¯ä»¥ä½¿ç”¨ï¼Œä½¿æˆ‘ä»¬å¯ä»¥é¢å‘ Android å’Œ iOS è¿›è¡Œå¼€å‘ï¼Œè€Œæ— éœ€æ‰“å¼€ Android Studio æˆ– Xcodeã€‚è¿™ä¸ªå·¥å…·çš„åå­—éå¸¸ç›´ç™½ï¼Œå«åš **Create React Native App**ã€‚å®ƒç±»ä¼¼äº **Create React App**ï¼Œå› ä¸ºä½ éœ€è¦åšçš„æ˜¯é€šè¿‡ NPM å®‰è£… CLIã€‚ç„¶åï¼Œé€šè¿‡ CLIï¼Œä½ å¯ä»¥è½»æ¾åœ°æ„å»ºèµ·ä¸€ä¸ªå…¨æ–°çš„ React Native é¡¹ç›®ã€‚

è·Ÿ Create React App ä¸€æ ·ï¼Œä½¿ç”¨ Create React Native App (CRNA) æœ‰ä¼˜ç‚¹ä¹Ÿæœ‰ç¼ºç‚¹ã€‚é¦–å…ˆæ¥è¯´ä¼˜ç‚¹ã€‚

### Create React Native App ä¼˜ç‚¹
æ¯”è¾ƒæ˜æ˜¾çš„ä¸€ä¸ªæ˜¯ Create React Native App æœ€å¤§é™åº¦åœ°å‡å°‘äº†åˆ›å»º "hello world" åº”ç”¨ç¨‹åºæ‰€éœ€çš„æ—¶é—´ã€‚äº‹å®ä¸Šï¼Œä½ å¯ä»¥åœ¨ç»ˆç«¯ä¸Šè¿è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œ15 ç§’é’Ÿåï¼Œä¸€ä¸ªä½¿ç”¨ JavaScript åœ¨ Android å’Œ iOS ä¸Šéƒ½å¯ä»¥è¿è¡Œçš„é¡¹ç›®å°±è¯ç”Ÿäº†ï¼Œè¿™ç®€ç›´ä¸å¯æ€è®®ã€‚æ¥ä¸‹æ¥ï¼ŒCreate React Native App è¿˜å…è®¸ä½ è½»æ¾åœ°åœ¨è‡ªå·±çš„è®¾å¤‡ä¸Šè¿›è¡Œå¼€å‘ï¼Œè¿™ä¸€ç‚¹æˆ‘ä»¬ç¨åæ·±å…¥äº†è§£ã€‚è¿™æ ·ï¼Œä½ åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­æ‰€åšçš„ä»»ä½•æ›´æ”¹å°†ç«‹å³æ˜¾ç¤ºåœ¨æœ¬åœ°æ‰‹æœºä¸Šè¿è¡Œçš„åº”ç”¨ä¸­ã€‚ç„¶åï¼Œï¼ˆè¿™ä¸€ç‚¹æˆ‘ä¹‹å‰æåˆ°è¿‡ï¼‰ï¼Œä½¿ç”¨ Create React Native Appï¼Œä½ åªéœ€è¦è¿™ä¸€ä¸ªæ„å»ºå·¥å…·å°±å¤Ÿäº†ã€‚ä½ ä¸å¿…æ‹…å¿ƒ Xcode æˆ– Android Studioã€‚æœ€åä¸€ç‚¹ï¼Œæ­¤å·¥å…·æ²¡æœ‰é”å®šã€‚å°±åƒ Create React App ä¸€æ ·ï¼Œä½ å¯ä»¥éšæ—¶"å¼¹å‡ºé…ç½®ï¼ˆejectï¼‰"ã€‚

### Create React Native ç¼ºç‚¹
æ­¤å·¥å…·è¿˜å­˜åœ¨ä¸€äº›ç¼ºç‚¹ï¼Œè™½ç„¶éƒ½æ¯”è¾ƒå°ï¼Œä½†ä¹Ÿå€¼å¾—æ³¨æ„ã€‚é¦–å…ˆï¼Œå¦‚æœä½ åœ¨æ„å»ºä¸€ä¸ªè¦æ·»åŠ åˆ°ç°æœ‰åŸç”Ÿ iOS æˆ– Android åº”ç”¨çš„åº”ç”¨ï¼ŒCreate React Native App å°±æ— æ³•ç”¨äº†ã€‚ç¬¬äºŒï¼Œå¦‚æœä½ éœ€è¦åœ¨ React Native å’Œä¸€äº› Create React Native App ä¸è®¤è¯†çš„åŸç”Ÿ API ä¹‹é—´å»ºç«‹æ¡¥æ¥ï¼ˆè¿™éå¸¸ç½•è§ï¼‰ï¼ŒCreate React Native App å°±æ— æ³•æ­£å¸¸å·¥ä½œäº†ã€‚

æˆ‘ä»¬æ¥çœ‹çœ‹å§ï¼

## å®‰è£… Create React Native App
ä¸ºäº†ä½¿ç”¨ Create React Native Appï¼Œè¯·å…ˆåœ¨å…¨å±€å®‰è£…å®ƒ:

```
npm install -g create-react-native-app
```
æˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨ **yarn**ï¼ˆè®¿é—®[æ­¤å¤„](https://yarnpkg.com/lang/en/docs/install/) äº†è§£å®‰è£…è¯´æ˜ï¼‰ï¼š

```
yarn global add create-react-native-app
```

>âš ï¸ **ä½¿ç”¨ Yarn** âš ï¸

>Create React Native App ç›®å‰æ— æ³•ä¸ NPM v5 ä¸€èµ·ä½¿ç”¨ï¼Œå› ä¸º[NPM ä¸­å­˜åœ¨é”™è¯¯](https://github.com/react-community/create-react-native-app/issues/233#issuecomment-305638103)ã€‚è™½ç„¶ NPM v3 æˆ– v4 åº”è¯¥æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯ä¿é™©èµ·è§ï¼Œåé¢æˆ‘ä»¬éƒ½ä½¿ç”¨ Yarnã€‚

## Expo(video1)

åœ¨è¿™é—¨è¯¾ç¨‹ä¸­ æˆ‘ä»¬å°†ç»å¸¸ç”¨åˆ°ä¸€ä¸ªæœåŠ¡ å«åšExpo,Expoè®©react nativeçš„ä½¿ç”¨è¿‡ç¨‹ç®€å•å¾ˆå¤šï¼Œexpoçš„å®—æ—¨æ˜¯å½“ä½ æ„å»ºreact nativeåº”ç”¨æ—¶ï¼Œä½ ä¸éœ€è¦å¤„ç†åŸç”Ÿä»£ç ï¼Œæ— è®ºæ˜¯Swift Objective-Cè¿˜æ˜¯java,ä½œä¸ºjavascriptçš„å¼€å‘è€…ï¼Œæˆ‘è§‰å¾—è¿™å¾ˆæ£’ï¼Œæ¯å½“æˆ‘ä»¬éœ€è¦å¤„ç†åŸç”Ÿapi,ä¾‹å¦‚ç›¸æœºæˆ–åœ°ç†ä½ç½®ï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨Xcodeæˆ–Android studio,è¿™ä¸¤ä¸ªå·¥å…·æ˜¯åœ¨ä»¤äººå¤´ç–¼ï¼Œç›¸åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨expoçš„javascript APIå®ç°ç›¸åŒçš„ç»“æœï¼Œæˆ‘ç®€ç›´æ— æ³•å½¢å®¹expoå¯¹react nativeç¤¾åŒºå¸¦æ¥çš„å½±å“å’Œä»·å€¼ã€‚react native team å’Œexpo teamæœ‰ä»€ä¹ˆå…³ç³»ï¼Œå®ƒä»¬çš„å…³ç³»å¾ˆäº²å¯†ï¼Œreact nativeçš„å¤§éƒ¨åˆ†ä¸»è¦è´¡çŒ®è€…éƒ½æ˜¯expoå…¨èŒå¼€å‘è€… æŸäº›ç”šè‡³æ˜¯å‰facebookå‘˜å·¥ï¼Œå®é™…ä¸Šcreate react nativeåº”ç”¨å°±æ˜¯ç”±expoå›¢é˜Ÿå¼€å‘çš„ å·²æˆä¸ºä½¿ç”¨react nativeæ„å»ºåº”ç”¨çš„å®˜æ–¹æ–¹å¼ã€‚

Expo æ˜¯ä¸€é¡¹æœåŠ¡ï¼Œå®ƒèƒ½ä½¿æ¶‰åŠ React Native çš„ä¸€åˆ‡éƒ½å˜å¾—éå¸¸å®¹æ˜“ã€‚Expo èƒŒåçš„æ€è·¯æ˜¯çœå» Android Studio æˆ– Xcode çš„ä½¿ç”¨ã€‚æ›´é‡è¦çš„æ˜¯ï¼šå®ƒç”šè‡³å…è®¸æˆ‘ä»¬ä½¿ç”¨ Windowsï¼ˆæˆ–ç”šè‡³ Linuxï¼‰é¢å‘ iOS è¿›è¡Œå¼€å‘ï¼

ä½¿ç”¨ Expoï¼Œä½ å¯ä»¥ä½¿ç”¨å·²ç»ç†Ÿæ‚‰çš„ JavaScript åŠ è½½å’Œè¿è¡Œç”± Create React Native App æ„å»ºçš„é¡¹ç›®ã€‚ä½ æ— éœ€ç¼–è¯‘ä»»ä½•åŸç”Ÿä»£ç ã€‚è€Œä¸”åƒ Create React App ä¸€æ ·ï¼Œå°† Expo ä¸ Create React Native App ä¸€èµ·ä½¿ç”¨ï¼Œå‡ ä¹ä¸ç”¨ä»€ä¹ˆé…ç½®å°±å¯ä»¥ä½¿æˆ‘ä»¬å¼€å§‹è¿è¡Œåº”ç”¨ã€‚

åœ¨æ­¤è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å¤§é‡ä¾èµ– Expoã€‚é¦–å…ˆ: ä½ éœ€è¦å®‰è£… Expoã€‚è¯·å‰å¾€åº”ç”¨å•†åº—ï¼Œå®‰è£…é€‚åˆä½ çš„è®¾å¤‡çš„ Expo ç§»åŠ¨åº”ç”¨ï¼š

* Google Play ä¸Šçš„ Expo (Android)
* App Store ä¸Šçš„ Expo (iOS) 

## Simulators
ç»“åˆ Expo ä¸ Create React Native App æ˜¯æ„å»ºåº”ç”¨çš„æœ€å¿«é€Ÿæ–¹å¼ï¼Œä½†ä¹Ÿæœ‰å…¶ä»–æ„å»ºé¡¹ç›®çš„æ–¹å¼ã€‚å¦‚æœä½ æƒ³å°† React Native é›†æˆåˆ°ç°æœ‰åº”ç”¨ä¸­ï¼Œæˆ–è€…å¦‚æœä½ å·²ä» Create React Native App å¼¹å‡ºåº”ç”¨ï¼Œå¯è‡ªè¡Œå‚è€ƒ React Native æ–‡æ¡£ä¸­çš„[ä½¿ç”¨åŸç”Ÿä»£ç æ„å»ºé¡¹ç›®](https://facebook.github.io/react-native/docs/getting-started.html) é€‰é¡¹å¡ã€‚æœ¬æŒ‡å—è¿˜è®¾ç½®äº† iOS å’Œ Android æ¨¡æ‹Ÿå™¨ï¼Œä»¥ä¾¿ä½ å¯ä»¥ç›´æ¥åœ¨è‡ªå·±çš„ç”µè„‘ä¸Šæ¬£èµè‡ªå·±çš„ç§»åŠ¨åº”ç”¨ï¼æˆ‘ä»¬å°†åœ¨æ­¤è¯¾ç¨‹ä¸­ä½¿ç”¨ iOS å’Œ Android æ¨¡æ‹Ÿå™¨è¿›è¡Œæ¼”ç¤ºï¼Œä½†åœ¨å…¥é—¨é˜¶æ®µä¸å¼ºåˆ¶è¦æ±‚ã€‚

>ğŸ’¡ Bundling Errorï¼ˆUnexpected Tokenï¼‰ğŸ’¡

>å¦‚æœä½ åœ¨å°è¯•è¿è¡Œæ¨¡æ‹Ÿå™¨æ—¶é‡åˆ°æ‰“åŒ…é”™è¯¯ï¼Œè¯·å°è¯•å°† React Native çš„ Babel é¢„è®¾æ›´æ”¹ä¸ºç‰ˆæœ¬` 2.1.0`ã€‚ç„¶åï¼Œåˆ é™¤ä½ çš„ `node-modules` ç›®å½•ï¼Œç”¨ `npm install` é‡æ–°å®‰è£…ï¼Œç„¶åå†æ¬¡è¿è¡Œæ¨¡æ‹Ÿå™¨ã€‚æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹æœ‰å…³ Stack Overflow çš„[æ­¤æ–‡ç« ](https://stackoverflow.com/questions/45725376/react-native-starter-project-bundling-fails-with-unexpected-token-error)ã€‚


##video2
è®¾ç½®äº†æ¨¡æ‹Ÿå™¨å¹¶å®‰è£…äº†create-react-native-appåï¼Œä¸‹ä¸€æ­¥æ˜¯æ‰“å¼€åº”ç”¨ï¼Œåœ¨terminalè¾“å…¥create-react-native-app UdaciFitness
ç„¶åå†yarn start,ä¼šçœ‹åˆ°æœ‰å‡ ä¸ªé€‰é¡¹ï¼Œa ä¼šåœ¨äºŒç»´ç ä¸Šè¿è¡Œï¼Œ

[è¿™æ˜¯åŒ…å«æ­¤è§†é¢‘ä¸­æ‰€åšæ›´æ”¹çš„æäº¤](https://github.com/udacity/reactnd-UdaciFitness-complete/commit/5fcff9e5f24616402a8503cf16c4df0328bd4397)

## ç¯å¢ƒ
åœ¨ä½¿ç”¨ Create React Native App åˆ›å»ºåº”ç”¨æ—¶ï¼Œä½ æœŸæœ›è·å¾—ä»€ä¹ˆç±»å‹çš„æ”¯æŒï¼Ÿ

* ES5 å’Œ ES6 æ”¯æŒ
* å¯¹è±¡å±•å¼€è¿ç®—ç¬¦
* å¼‚æ­¥å‡½æ•°
* JSXï¼ˆæ¯•ç«Ÿè¿™æ˜¯Reactï¼ï¼‰
* [Flow](https://flow.org/)
* [Fetch](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)

ç”±äºæˆ‘ä»¬çº¯ç²¹ä½¿ç”¨ JavaScript æ¥æ„å»ºç§»åŠ¨åº”ç”¨ï¼Œè¿™ä¸ªåˆ—è¡¨æ²¡æœ‰ä»€ä¹ˆå¥½æƒŠå¥‡çš„ï¼ç”±äº Create React Native App éš Babel ä¸€èµ·æä¾›ï¼Œè¯·è‡ªè¡ŒæŸ¥çœ‹[æ”¯æŒçš„è½¬æ¢](https://github.com/facebook/react-native/blob/master/babel-preset/configs/main.js#L16) çš„å®Œæ•´åˆ—è¡¨ã€‚

åœ¨å¼€å§‹å®é™…æ„å»ºåº”ç”¨ä¹‹å‰ï¼Œæœ‰ä¸€äº›æ–‡ä»¶æ˜¯é¡¹ç›®æ‰€å¿…éœ€çš„ï¼Œä½†ä½ ä¸å¿…å®Œå…¨ç†è§£ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åªç»™ä½ æä¾›ä»£ç ï¼Œæ„Ÿå…´è¶£çš„è¯å¯ä»¥çœ‹çœ‹ã€‚

æ‰€æœ‰è¿™ä¸‰ä¸ªæ–‡ä»¶éƒ½å°†ä½äº `utils` æ–‡ä»¶å¤¹ä¸­ã€‚é¦–å…ˆï¼Œåœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º utils çš„æ–‡ä»¶å¤¹ã€‚

æ¥ä¸‹æ¥ï¼Œä½ è¦åœ¨ `utils `æ–‡ä»¶å¤¹å†…åˆ›å»ºä¸‰ä¸ªæ–‡ä»¶ã€‚

* colors.js
* helpers.js
* _calendar.jsï¼ˆç¡®ä¿åŒ…å«ä¸‹åˆ’çº¿ï¼ï¼‰

å°†ä»¥ä¸‹ä»£ç ç²˜è´´åˆ°`utils/colors.js`æ–‡ä»¶ä¸­

```
// utils/colors.js

export const purple = '#292477'
export const gray = '#757575'
export const white = '#fff'
export const red = '#b71845'
export const orange = '#f26f28'
export const blue = '#4e4cb8'
export const lightPurp = '#7c53c3'
export const pink = '#b93fb3'
```

æ¥ä¸‹æ¥ï¼Œå°†ä»¥ä¸‹ä»£ç ç²˜è´´åˆ° utils/helpers.js ä¸­

```
// utils/helpers.js

export function isBetween (num, x, y) {
  if (num >= x && num <= y) {
    return true
  }

  return false
}

export function calculateDirection (heading) {
  let direction = ''

  if (isBetween(heading, 0, 22.5)) {
    direction = 'North'
  } else if (isBetween(heading, 22.5, 67.5)) {
    direction = 'North East'
  } else if (isBetween(heading, 67.5, 112.5)) {
    direction = 'East'
  } else if (isBetween(heading, 112.5, 157.5)) {
    direction = 'South East'
  } else if (isBetween(heading, 157.5, 202.5)) {
    direction = 'South'
  } else if (isBetween(heading, 202.5, 247.5)) {
    direction = 'South West'
  } else if (isBetween(heading, 247.5, 292.5)) {
    direction = 'West'
  } else if (isBetween(heading, 292.5, 337.5)) {
    direction = 'North West'
  } else if (isBetween(heading, 337.5, 360)) {
    direction = 'North'
  } else {
    direction = 'Calculating'
  }

  return direction
}

export function timeToString (time = Date.now()) {
  const date = new Date(time)
  const todayUTC = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()))
  return todayUTC.toISOString().split('T')[0]
}
```

æœ€åï¼Œå°†ä»¥ä¸‹ä»£ç ç²˜è´´åˆ° utils/_calendar.js æ–‡ä»¶ä¸­ã€‚

```
// utils/_calendar.js

import { AsyncStorage } from 'react-native'
import { getMetricMetaInfo, timeToString } from './helpers'

export const CALENDAR_STORAGE_KEY = 'UdaciFitness:calendar'

function getRandomNumber (max) {
  return Math.floor(Math.random() * max) + 0
}

function setDummyData () {
  const { run, bike, swim, sleep, eat } = getMetricMetaInfo()

  let dummyData = {}
  const timestamp = Date.now()

  for (let i = -183; i < 0; i++) {
    const time = timestamp + i * 24 * 60 * 60 * 1000
    const strTime = timeToString(time)
    dummyData[strTime] = getRandomNumber(3) % 2 === 0
      ? {
          run: getRandomNumber(run.max),
          bike: getRandomNumber(bike.max),
          swim: getRandomNumber(swim.max),
          sleep: getRandomNumber(sleep.max),
          eat: getRandomNumber(eat.max),
        }
      : null
  }

  AsyncStorage.setItem(CALENDAR_STORAGE_KEY, JSON.stringify(dummyData))

  return dummyData
}

function setMissingDates (dates) {
  const length = Object.keys(dates).length
  const timestamp = Date.now()

  for (let i = -183; i < 0; i++) {
    const time = timestamp + i * 24 * 60 * 60 * 1000
    const strTime = timeToString(time)

    if (typeof dates[strTime] === 'undefined') {
      dates[strTime] = null
    }
  }

  return dates
}

export function formatCalendarResults (results) {
  return results === null
    ? setDummyData()
    : setMissingDates(JSON.parse(results))
}
```

[è¿™æ˜¯åŒ…å«åœ¨ `utils` æ–‡ä»¶å¤¹ä¸­æ‰€åšæ›´æ”¹çš„æäº¤ã€‚](https://github.com/udacity/reactnd-UdaciFitness-complete/commit/6ecbdd5a5685c819fb511e2fb5dc4de0d4dd0ab0)

## æ€»ç»“
**Create React Native App** ç±»ä¼¼äº **Create React App**ï¼Œåœ¨äºå®ƒåªéœ€æœ€å°‘çš„é…ç½®ä¾¿èƒ½æ„å»ºèµ·å§‹åº”ç”¨ç¨‹åº:

* èŠ±æœ€å°‘çš„"æ—¶é—´æ„å»ºèµ· 'Hello World'"
* åœ¨ä½ è‡ªå·±çš„è®¾å¤‡ä¸Šé€šè¿‡ Expo è¿›è¡Œå¼€å‘
* åªéœ€å•ä¸ªæ„å»ºå·¥å…·
* ä¸é”å®šï¼ˆå³éšæ—¶å¼¹å‡ºï¼‰

ä½ ä¹Ÿå¯ä»¥è®¾ç½®**æ¨¡æ‹Ÿå™¨**æ¥å¸®åŠ©å¼€å‘ã€‚ä½†æ— è®ºæˆ‘ä»¬é€‰æ‹©å“ªç§å¼€å‘å¹³å°ï¼ˆiOSã€Androidï¼‰ä»¥åŠå“ªç§ç¯å¢ƒï¼ˆMacã€Windowsã€Linuxï¼‰-- æˆ‘ä»¬å®Œå…¨åœ¨ä½¿ç”¨ç†Ÿæ‚‰çš„æ—§ JavaScript è¿›è¡Œæ„å»ºï¼